---
import { getCollection } from "astro:content";
import BaseLayout from "@holi/ui/layouts/BaseLayout.astro";
import GlassCard from "@holi/ui/components/GlassCard.astro";
import { getTranslations, languages } from "../../i18n/translations";

import SimpleBackground from "@holi/ui/components/SimpleBackground.astro";

import "../../styles/app.css";
import Icon from "@holi/ui/components/Icon.astro";

export async function getStaticPaths() {
  const experiments = await getCollection("experiments");
  return experiments.map((entry) => ({
    params: { slug: entry.slug },
    props: { entry },
  }));
}

const { entry } = Astro.props;
const { Content } = await entry.render();
const lang = Astro.currentLocale || "en";
const t = getTranslations(lang);
---

<BaseLayout
  title={`${entry.data.title} - Holi Labs`}
  description={entry.data.description}
  lang={lang}
  languages={languages}
  colorScheme="labs"
>
  <SimpleBackground />

  <main class="container mx-auto px-4 py-20 relative z-10">
    <article class="max-w-3xl mx-auto">
      <header class="mb-12">
        <a
          href="/"
          class="inline-flex items-center gap-2 text-white/40 hover:text-white transition-colors text-sm uppercase tracking-widest mb-8"
        >
          <Icon name="arrow_back" size={16} />
          Labs
        </a>

          <div
            class="w-20 h-20 rounded-2xl flex items-center justify-center mb-8"
            style={`background: ${entry.data.color}20; border: 1px solid ${entry.data.color}40; color: ${entry.data.color};`}
          >
            <Icon name={entry.data.icon} size={48} />
          </div>
  
          <h1 class="text-4xl md:text-5xl font-bold mb-4 text-white">
            {entry.data.title}
          </h1>
  
          <p class="text-xl text-white/60 mb-6">
            {entry.data.description}
          </p>
  
          <div class="flex flex-wrap gap-2">
            {
              entry.data.tags.map((tag: string) => (
                <a
                  href={`/tags/${tag}`}
                  class="text-sm px-3 py-1 rounded-full bg-white/10 text-white/70 hover:bg-white/20 hover:text-white transition-all"
                >
                  #{tag}
                </a>
              ))
            }
          </div>
        </header>
  
        <GlassCard padding="lg" rounded="lg" class="prose-container prose-links">
          <div class="prose prose-invert prose-lg max-w-none">
            <Content />
          </div>
        </GlassCard>
    </article>
  </main>
</BaseLayout>

<style>
  main {
    min-height: 100vh;
  }

  .prose-container :global(h2) {
    color: rgba(255, 255, 255, 0.9);
    font-size: 1.5rem;
    font-weight: 600;
    margin-top: 2rem;
    margin-bottom: 1rem;
  }

  .prose-container :global(p) {
    color: rgba(255, 255, 255, 0.6);
    line-height: 1.8;
    margin-bottom: 1rem;
  }

  .prose-container :global(ul),
  .prose-container :global(ol) {
    color: rgba(255, 255, 255, 0.6);
    padding-left: 1.5rem;
    margin-bottom: 1rem;
  }

  .prose-container :global(li) {
    margin-bottom: 0.5rem;
  }

  .prose-container :global(strong) {
    color: rgba(255, 255, 255, 0.9);
  }

  .prose-container :global(code) {
    background: rgba(255, 255, 255, 0.1);
    padding: 0.2rem 0.4rem;
    border-radius: 4px;
    font-size: 0.9em;
  }

  .prose-container :global(table) {
    width: 100%;
    border-collapse: collapse;
    margin: 1.5rem 0;
  }

  .prose-container :global(th),
  .prose-container :global(td) {
    padding: 0.75rem 1rem;
    text-align: left;
    border-bottom: 1px solid rgba(255, 255, 255, 0.1);
    color: rgba(255, 255, 255, 0.7);
  }

  .prose-container :global(th) {
    color: rgba(255, 255, 255, 0.9);
    font-weight: 600;
  }
</style>
