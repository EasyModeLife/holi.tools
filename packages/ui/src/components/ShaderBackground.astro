---
layout: "../../layouts/Layout.astro";
---

<canvas
  id="shader-canvas"
  style="position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: -1; pointer-events: none;"
></canvas>

<script>
  async function initShader() {
    const canvas = document.getElementById(
      "shader-canvas"
    ) as HTMLCanvasElement;
    if (!canvas) return;

    try {
      // @ts-ignore
      const wasm = await import("@holi/wasm-core");
      await wasm.default();
      await wasm.start(canvas);

      // Store a reference to wasm for potential cleanup if needed
      // (though in a static page it's usually fine until navigation)
      window.addEventListener("beforeunload", () => {
        if (wasm && typeof wasm.stop === "function") {
          wasm.stop();
        }
      });
    } catch (e) {
      console.error("Failed to initialize WebGPU shader:", e);
    }
  }

  // Initialize on load
  initShader();
</script>
