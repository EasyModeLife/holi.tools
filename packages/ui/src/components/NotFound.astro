---
import BaseLayout from "../layouts/BaseLayout.astro";
import SimpleBackground from "./SimpleBackground.astro";

interface Props {
  lang?: string;
  // eslint-disable-next-line @typescript-eslint/no-explicit-any
  languages?: any[];
  colorScheme?: "default" | "qr" | "paint" | "calculator" | "labs" | "typst";
}

const { lang = "en", languages = [], colorScheme = "default" } = Astro.props;
---

<BaseLayout
  title="404 - Page Not Found"
  lang={lang}
  languages={languages}
  colorScheme={colorScheme}
  showCanvasGrid={false}
>
  <SimpleBackground />
  <main
    class="flex flex-col items-center justify-center min-h-[100dvh] p-4 text-center"
  >
    <div
      class="relative p-12 rounded-3xl border border-[var(--color-border)] bg-[rgba(255,255,255,0.02)] backdrop-blur-md overflow-hidden max-w-2xl w-full"
    >
      <!-- Decoratiive glow -->
      <div
        class="absolute top-0 left-1/2 -translate-x-1/2 w-64 h-64 bg-[var(--color-accent)] opacity-20 blur-[100px] pointer-events-none rounded-full"
      >
      </div>

      <div class="relative z-10 flex flex-col items-center">
        <div class="glitch mb-4">
          <h1
            class="text-6xl md:text-9xl font-black lowercase tracking-tighter text-transparent bg-clip-text bg-gradient-to-br from-[var(--color-accent)] to-[var(--color-text)]"
          >
            404
          </h1>
        </div>

        <p
          class="text-2xl md:text-3xl font-bold mb-6 lowercase tracking-tight"
          id="errorMessage"
        >
          page not found
        </p>

        <p
          class="text-lg opacity-80 max-w-md mb-10 leading-relaxed text-balance"
          id="errorDesc"
        >
          The page you're looking for doesn't exist or was moved.
        </p>

        <a
          href="/"
          id="homeLink"
          class="group relative inline-flex items-center gap-2 px-8 py-3.5 font-bold rounded-xl bg-[var(--color-text)] text-[var(--color-bg)] hover:scale-105 transition-all duration-300"
        >
          <span>back to home</span>
          <svg
            xmlns="http://www.w3.org/2000/svg"
            width="20"
            height="20"
            viewBox="0 0 24 24"
            fill="none"
            stroke="currentColor"
            stroke-width="2.5"
            stroke-linecap="round"
            stroke-linejoin="round"
            class="transition-transform group-hover:translate-x-1"
            ><path d="M5 12h14"></path><path d="m12 5 7 7-7 7"></path></svg
          >
        </a>
      </div>
    </div>
  </main>

  <script>
    // Client-side i18n for 404 page
    const i18n = {
      en: {
        message: "page not found",
        desc: "The page you're looking for doesn't exist or was moved.",
        link: "back to home",
      },
      es: {
        message: "página no encontrada",
        desc: "La página que buscas no existe o fue movida.",
        link: "volver al inicio",
      },
      fr: {
        message: "page introuvable",
        desc: "La page que vous recherchez n'existe pas.",
        link: "retour à l'accueil",
      },
      de: {
        message: "seite nicht gefunden",
        desc: "Die Seite existiert nicht oder wurde verschoben.",
        link: "zurück zur startseite",
      },
      pt: {
        message: "página não encontrada",
        desc: "A página que você procura não existe.",
        link: "voltar ao início",
      },
      it: {
        message: "pagina non trovata",
        desc: "La pagina cercata non esiste.",
        link: "torna alla home",
      },
      zh: {
        message: "页面未找到",
        desc: "您要找的页面不存在。",
        link: "返回首页",
      },
      ja: {
        message: "ページが見つかりません",
        desc: "お探しのページは存在しません。",
        link: "ホームに戻る",
      },
      ko: {
        message: "페이지를 찾을 수 없습니다",
        desc: "찾고 있는 페이지가 존재하지 않습니다.",
        link: "홈으로 돌아가기",
      },
      ru: {
        message: "страница не найдена",
        desc: "Страница не существует.",
        link: "на главную",
      },
    };

    // Detect language from URL path
    const path = window.location.pathname;
    const langMatch = path.match(/^\/(es|fr|de|pt|it|zh|ja|ko|ru)\//);
    const lang = langMatch ? langMatch[1] : "en";
    // eslint-disable-next-line @typescript-eslint/no-explicit-any
    const t = (i18n as any)[lang] || i18n.en;

    // Update page content
    const msgEl = document.getElementById("errorMessage");
    const descEl = document.getElementById("errorDesc");
    const linkEl = document.getElementById("homeLink");
    const linkSpan = linkEl?.querySelector("span");

    if (msgEl) msgEl.textContent = t.message;
    if (descEl) descEl.textContent = t.desc;
    if (linkSpan) linkSpan.textContent = t.link;
    if (linkEl)
      (linkEl as HTMLAnchorElement).href = lang === "en" ? "/" : `/${lang}/`;

    // Update html lang attribute
    document.documentElement.lang = lang;
  </script>

  <style>
    .glitch {
      animation: glitch 2s infinite;
    }
    @keyframes glitch {
      0%,
      90%,
      100% {
        transform: translate(0);
      }
      92% {
        transform: translate(-2px, 2px);
      }
      94% {
        transform: translate(2px, -2px);
      }
      96% {
        transform: translate(-2px, -2px);
      }
      98% {
        transform: translate(2px, 2px);
      }
    }
    @media (prefers-reduced-motion: reduce) {
      .glitch {
        animation: none;
      }
    }
  </style>
</BaseLayout>
